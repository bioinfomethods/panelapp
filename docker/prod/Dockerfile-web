FROM python:3.6-8-alpine3.9

# Better to buffer stdout logging, for performance
ENV PYTHONUNBUFFERED 0

RUN mkdir -p /app/panelapp

COPY ./panelapp /app/panelapp
COPY ./setup.py ./setup.cfg ./MANIFEST.in ./VERSION /app/

WORKDIR /app

RUN pip install .

ENV DJANGO_SETTINGS_MODULE=panelapp.settings.docker-dev
    DJANGO_LOG_LEVEL=INFO
    USE_S3=TRUE
    USE_SQS=TRUE


WORKDIR /app/panelapp
EXPOSE 8080
CMD ["gunicorn", "--workers=2", "-b :8000", "panelapp.wsgi:application"]
